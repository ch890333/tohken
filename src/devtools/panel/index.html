<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="assets/main.css">
</head>

<body id="app">
  <ul class="top">
    <li>審神者<b v-if="view.player.name!=null">{{view.player.name}}</b></li>
    <li v-if="view.player.level!=null">Lv.<b>{{view.player.level}}</b></li>
    <li v-if="!view.resource.set">暫未獲取資料，請進入本丸分頁</li>
    <li> 目前版本： <b>V0.3.0.1111</b></li>
    <!-- 簡化套件header
    <li v-if="view.resource.charcoal!=null">木炭<b>{{Math.floor(view.resource.charcoal)}}</b></li>
    <li v-if="view.resource.steel!=null">玉鋼<b>{{Math.floor(view.resource.steel)}}</b></li>
    <li v-if="view.resource.coolant!=null">冷却材<b>{{Math.floor(view.resource.coolant)}}</b></li>
    <li v-if="view.resource.file!=null">砥石<b>{{Math.floor(view.resource.file)}}</b></li>
    <li v-if="view.resource.bill!=null">依頼札<b>{{Math.floor(view.resource.bill)}}</b></li>
    <li v-if="view.resource.bonemeal!=null">手伝い札<b>{{Math.floor(view.resource.bonemeal)}}</b></li>
    <li v-if="view.resource.money!=null">小判<b>{{Math.floor(view.resource.money)}}</b></li>
    -->
  </ul>
  <ul class="nav">
    <li v-class="active: tab == 2" v-on="click: tab = 2">隊伍</li>
    <li v-class="active: tab == 3" v-on="click: tab = 3">本丸</li>
    <!-- 工程中
    <li v-class="active: tab == 3" v-on="click: tab = 4">..</li>
  -->
    <li v-class="active: tab == 5" v-on="click: tab = 5">紀錄</li>
    <li v-class="active: tab == -1" v-on="click: tab = -1">設定</li>
    <li v-class="active: tab == -2" v-on="click: tab = -2">關於套件</li>
  </ul>
  <div class="container">
    <div v-if="!gaming" class="outgame">暫未取得資料，如已開啟【儲存遊戲資料】功能，顯示的應為先前的暫存紀錄</div>
    <!-- 分頁 #2：队伍列表 -->
    <div v-if="!view['party']['set']" v-show="tab==2">暫未取得隊伍資料，請進入結成頁面</div>
    <div v-if="view['party']['set']" v-show="tab==2">
      <div v-if="view['party']['set']" class="party">
        <div v-repeat="view['party']['data']" class="party-item">
          <!-- 队伍和状态标注-->
          <div class="name">{{party_name}}<span v-show="in_battle(party_no)" class="status">[战斗中]</span>
            <span v-show="status==2" class="status">[遠征中]</span><span v-show="status==2" class="status">[{{finished_at | conquest_time}}]</span>
            <span v-show="status==2" class="status">[工程預定位置]</span>
          </div>
          <!-- 等级和兵力标注-->
          <div class="amounts">
            <span class="alv">  Average Lv.<b>{{avearge_lv}} </b></span>
            <span class="lva">Total Lv.<b>{{amount_lv}}</b>
            </span>
          </div>
          <!-- 列表-->
          <ul class="swords">
            <li v-repeat="slot" class="ss">
              <div v-if="serial_id==null" class="item"><img src="../../assets/sword/0.png" class="simg">
                <div class="c">
                  <div class="sname">空</div>
                  <div class="slv">Lv.0 (next 0)</div>
                </div>
                <div class="c">
                  <div class="shp">HP 0 / 0</div>
                  <div class="sf">
                    <span class="sfico"></span>0
                  </div>
                </div>
                <div class="c2">
                  <div class="sequ"><span>[空]</span></div>
                </div>
              </div>
              <div v-if="serial_id!=null" class="item"><img v-attr="src: '../../assets/sword/' + sword_id + '.png'" class="simg">
                <div class="c">
                  <div class="sname">{{name}}<span v-show="status==1" class="ssta">[手入]</span><span v-show="hp/hp_max&lt;=0.9 &amp;&amp; hp/hp_max&gt;0.65 &amp;&amp; status!=1" class="ssta y">[軽傷]</span><span v-show="hp/hp_max&lt;=0.65 &amp;&amp; hp/hp_max&gt;0.3 &amp;&amp; status!=1" class="ssta o">[中傷]</span><span v-show="hp/hp_max&lt;=0.3&amp;&amp;status!=1" class="ssta r">[重傷]</span></div>
                  <div class="slv">Lv.{{level}}(next {{next_exp}})</div>
                </div>
                <div class="c">
                  <div class="shp">HP {{hp}} / {{hp_max}}</div>
                  <div class="sf"><span v-class="r: fatigue &lt; 6,y: fatigue &gt;= 6 &amp;&amp; fatigue &lt; 20,p: fatigue &gt;= 50" class="sfico"></span><span v-show="fatigue &gt;= 50">桜吹雪</span><span v-show="fatigue &lt; 50 &amp;&amp; fatigue &gt;= 20">通常</span><span v-show="fatigue &lt; 20">疲労</span><span>{{fatigue}}</span><span v-show="fatigue &gt;= 50">(+20%)</span><span v-show="fatigue &gt;= 6 &amp;&amp; fatigue &lt; 20">(-20%)</span><span v-show="fatigue &lt; 6">(-40%)</span></div>
                </div>
                <div class="c2">
                  <div class="sequ"><span v-if="equip_serial_id1!=null" v-class="r: equip_1['level'] == 2, ur: equip_1['level'] == 0, b: equip_1['soldier_now'] == 0">[{{equip_1['sname']}} {{equip_1['soldier_now']}}/{{equip_1['soldier_max']}}]</span><span v-if="equip_serial_id1==null&amp;&amp;max_equip&gt;=1">[空]</span>
                    <span v-if="equip_serial_id2!=null" v-class="r: equip_2['level'] == 2, ur: equip_2['level'] == 0, b: equip_2['soldier_now'] == 0">[{{equip_2['sname']}} {{equip_2['soldier_now']}}/{{equip_2['soldier_max']}}]</span>
                    <span v-if="equip_serial_id2==null&amp;&amp;max_equip&gt;=2">[空]</span>
                    <span v-if="equip_serial_id3!=null" v-class="r: equip_3['level'] == 2, ur: equip_3['level'] == 0, b: equip_3['soldier_now'] == 0">[{{equip_3['sname']}} {{equip_3['soldier_now']}}/{{equip_3['soldier_max']}}]</span>
                    <span v-if="equip_serial_id3==null&amp;&amp;max_equip&gt;=3">[空]</span></div>
                </div>
              </div>
            </li>
          </ul>
          <div class="clear"></div>
        </div>
      </div>
    </div>
    <!-- 分頁 #3：本丸 -->
    <div v-if="tab==3" class="forge-rep">
      <div class="panel fr">
        <div class="t">本丸資產</div>
        <li>木炭：<b v-if="view.resource.charcoal!=null">{{Math.floor(view.resource.charcoal)}}</b></li>
        <li>玉鋼：<b v-if="view.resource.steel!=null">{{Math.floor(view.resource.steel)}}</b></li>
        <li>冷却材：<b v-if="view.resource.coolant!=null">{{Math.floor(view.resource.coolant)}}</b></li>
        <li>砥石：<b v-if="view.resource.file!=null">{{Math.floor(view.resource.file)}}</b></li>
        <li>依頼札：<b v-if="view.resource.bill!=null">{{Math.floor(view.resource.bill)}}</b></li>
        <li>手伝い札：<b v-if="view.resource.bonemeal!=null">{{Math.floor(view.resource.bonemeal)}}</b></li>
        <li>小判：<b v-if="view.resource.money!=null">{{Math.floor(view.resource.money)}}</b></li>
        手伝い札、小判数量僅於登入遊戲時可取得資訊，所以數值不會變化
      </div>
      <div class="panel fr">
        <div class="t">刀裝‧馬</div>
        <!-- 無法單純顯示未裝備刀裝 僅可顯示所有資源 -->
        <div v-show="!view['equips']['set']" class="amounts">暫未取得資料，請進入結成頁面</div>
        <ul v-if="view['equips']['set']" class="equ" and class="5equ">
          <li v-repeat="view['equips']['data']">[{{$key | e2n}}] 持有 {{$value}}</li>
        </ul>
      </div>
      <!--
      <div class="panel fr">
        <div class="t">馬</div>
         
        <div v-show="!view['equips']['set']" class="amounts">暫未取得資料，請進入結成頁面</div>
        <ul v-if="view['equips']['set']" class="equ" >
          <li v-repeat="view['equips']['data']">[{{$key | e2n}}] 持有 {{$value}}</li>
        </ul>
      </div>
       -->
      <div class="panel fr">
        <div class="t">锻刀<span style="cursor: pointer;" v-on="click: toggleForge" class="alv">[點擊查看或關閉劇透]</span></div>
        <div class="amounts"><span class="alv">工坊<b>{{data['forge']['open']}}</b></span><span class="lva">使用中<b>{{checkout('forge')}}</b></span></div>
        <ul class="equ">
          <li v-repeat="data['forge']['data']">[{{finished_at | tt2lt}}] {{sword_id | fs2n}}</li>
        </ul>
      </div>
      <div class="panel fr">
        <div class="t">手入</div>
        <div class="amounts"><span class="alv">工坊<b>{{data['repair']['open']}}</b></span><span class="lva">使用中<b>{{checkout('repair')}}</b></span></div>
        <ul class="equ">
          <li v-repeat="data['repair']['data']">[{{finished_at | tt2lt}}] {{sword_serial_id | sid2n}}</li>
        </ul>
      </div>
    </div>
    <!-- 分頁 #4：發展 -->
    <div v-if="tab==4" class="forge-rep">
      <div class="panel fr">
        <div class="t">未手入刀劍清單</div>
        <li>木炭：<b v-if="view.resource.charcoal!=null">{{Math.floor(view.resource.charcoal)}}</b></li>
        <li>小判：<b v-if="view.resource.money!=null">{{Math.floor(view.resource.money)}}</b></li>
      </div>
      <div class="panel fr">
        <div class="t">數值未滿刀劍清單</div>
        <li>木炭：<b v-if="view.resource.charcoal!=null">{{Math.floor(view.resource.charcoal)}}</b></li>
        <li>小判：<b v-if="view.resource.money!=null">{{Math.floor(view.resource.money)}}</b></li>
      </div>
    </div>

    <!-- 分頁 #5 ：紀錄 -->
    <div v-if="tab==5" class="logs">
      <div class="panel">

        <div style="cursor: pointer;" v-on="click: saveLogs()" class="t">←點擊另存原始數據(CSV文件)</div>
      </div>
      <div class="panel">
        <div class="t">鍛刀紀錄</div>
        <table>
          <thead>
            <tr>
              <th>時間</th>
              <th>結果</th>
              <th>耗時</th>
              <th>木炭</th>
              <th>玉鋼</th>
              <th>冷却材</th>
              <th>砥石</th>
            </tr>
          </thead>
          <tbody>
            <tr v-repeat="data['logs']['forge']">
              <!-- "1-1426389451000":{"slot_no":"1","finish_at":1426389451000,"sword_id":"45","resource":false,"charcoal":"50","coolant":"50","file":"50","steel":"50"}-->
              <td>{{finish_at | ls2t}}</td>
              <td>{{sword_id | ls2n}}</td>
              <td>{{resource?times:'-'}} min</td>
              <td>{{resource?charcoal:'-'}}</td>
              <td>{{resource?steel:'-'}}</td>
              <td>{{resource?coolant:'-'}}</td>
              <td>{{resource?file:'-'}}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="panel">
        <div class="t">撿刀紀錄</div>
        <table>
          <thead>
            <tr>
              <th>時間</th>
              <th>隊伍</th>
              <th>評分</th>
              <th>獲得</th>
              <th>地圖</th>
              <th>位置</th>
            </tr>
          </thead>
          <tbody>
            <tr v-repeat="data['logs']['battle']">
              <td>{{time | ls2t}}</td>
              <td>{{party_no}}</td>
              <td>{{rank | r2r}}</td>
              <td>{{get_sword_id | ls2n}}</td>
              <td v-if="battle_episode>=0">{{battle_episode}}-{{battle_field}}</td>
              <td v-if="battle_episode<0">ev</td>
              <td>{{battle_pos}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <!-- 分頁 #-1：設定 功能-->
    <div v-show="tab==-1">
      <div class="panel-config">
        <div class="t">功能</div>
        <ul class="sl">
          <li>
            <div class="act">疲勞估算功能<span v-class="on: config.cad == 0" v-on="click: applyConfig('cad', 0)">OFF</span><span v-class="on: config.cad == 1" v-on="click: applyConfig('cad', 1)">ON</span></div>
            <div class="desc">[建議開啟]</div>
            <div class="desc">因为从游戏数据中只能拿到【休息和战斗时就算刷新游戏也没有变化的】疲劳数据。开启该功能后会根据toulove上的说明进行模拟演算。</div>
            <div class="desc">恢复时间为每三分钟恢复三点。</div>
            <div class="desc">但是你要是不开启这个功能的话就算你退游戏一晚上起来虽然体力值都应该恢复到49了但是数据上还是会维持疲劳状态。</div>
            <div class="desc">目前尚未发现获得完全准确数据的方法。</div>
          </li>
          <li>
            <div class="desc">...</div>
            <div class="act">在结成界面显示真实疲劳数据<span v-class="on: config.cadOffList == 0" v-on="click: applyConfig('cadOffList', 0)">OFF</span><span v-class="on: config.cadOffList == 1" v-on="click: applyConfig('cadOffList', 1)">ON</span></div>
            <div class="desc">[不建議開啟]</div>
            <div class="desc">这个选项被留下的目的是为了方便调试。</div>
          </li>
        </ul>
      </div>

    </div>
    <!-- 分頁 #-1：設定 資料-->
    <div v-show="tab==-1">
      <div class="panel-config">
        <div class="t">資料</div>
        <ul class="sl">
          <li>
            <div class="act">本機資料暫存<span v-class="on: config.dataCache == 0" v-on="click: applyConfig('dataCache', 0)">OFF</span><span v-class="on: config.dataCache == 1" v-on="click: applyConfig('dataCache', 1)">ON</span></div>
            <div class="desc">[建議開啟]</div>
            <div class="desc">將遊戲資料暫存於本機。開啟後：戰鬥中不小心關閉套件，可重新開啟套件並解析戰鬥數據；</div>
            <div class="desc">注：需開啟本功能，紀錄分頁中的鍛刀紀錄與撿刀紀錄，才能將歷史紀錄存下來。</div>
            <div v-show="dataExist" v-on="click: applyConfig('dataCache', -1)" style="cursor: pointer;" class="desc">
              < ** 清除過去紀錄 **>
            </div>
          </li>
        </ul>
      </div>
    </div>
    <!-- 分頁 #-1：設定 彈出視窗-->
    <div v-show="tab==-1">
      <div class="panel-config">
        <div class="t">彈出視窗</div>
        <ul class="sl">
          <li>
            <div class="act">遠征時間提醒<span v-class="on: config.notify_conquest == 0" v-on="click: applyConfig('notify_conquest', 0)">關閉</span><span v-class="on: config.notify_conquest == 1" v-on="click: applyConfig('notify_conquest', 1)">五分鐘前</span><span v-class="on: config.notify_conquest == 2" v-on="click: applyConfig('notify_conquest', 2)">兩分鐘前</span><span v-class="on: config.notify_conquest == 3" v-on="click: applyConfig('notify_conquest', 3)">半分鐘前</span><span v-class="on: config.notify_conquest == 4" v-on="click: applyConfig('notify_conquest', 4)">結束時</span></div>
            <div class="desc">遠征結束提醒。</div>
          </li>
          <li>
            <div class="desc">...</div>
            <div class="act">手入時間提醒<span v-class="on: config.notify_repair == 0" v-on="click: applyConfig('notify_repair', 0)">關閉</span><span v-class="on: config.notify_repair == 1" v-on="click: applyConfig('notify_repair', 1)">五分鐘前</span><span v-class="on: config.notify_repair == 2" v-on="click: applyConfig('notify_repair', 2)">兩分鐘前</span><span v-class="on: config.notify_repair == 3" v-on="click: applyConfig('notify_repair', 3)">半分鐘前</span><span v-class="on: config.notify_repair == 4" v-on="click: applyConfig('notify_repair', 4)">結束時</span></div>
            <div class="desc">
              手入結束提醒。 * [待解决]使用手伝い札時，提醒不會消失。
            </div>
          </li>
          <li>
            <div class="desc">...</div>
            <div class="act">戰鬥損失提醒<span v-class="on: config.notify_broken == 0" v-on="click: applyConfig('notify_broken', 0)">關閉</span><span v-class="on: config.notify_broken == 1" v-on="click: applyConfig('notify_broken', 1)">重傷</span><span v-class="on: config.notify_broken == 2" v-on="click: applyConfig('notify_broken', 2)">中傷</span><span v-class="on: config.notify_broken == 3" v-on="click: applyConfig('notify_broken', 3)">輕傷</span><span v-class="on: config.notify_broken == 4" v-on="click: applyConfig('notify_broken', 4)">掉血</span><span v-class="on: config.notify_broken == 5" v-on="click: applyConfig('notify_broken', 5)">刀裝</span></div>
            <div class="desc">戰鬥損失提醒。</div>
            <div class="desc">提醒级别向下包含：选择刀装，則掉血、轻伤等状态都会弹出提醒。</div>
          </li>
          <li>
            <div class="desc">...</div>
            <div class="act">戰鬥掉落提醒<span v-class="on: config.notify_getnew == 0" v-on="click: applyConfig('notify_getnew', 0)">關閉</span><span v-class="on: config.notify_getnew == 1" v-on="click: applyConfig('notify_getnew', 1)">只提醒亚欧刀</span><span v-class="on: config.notify_getnew == 2" v-on="click: applyConfig('notify_getnew', 2)">只提醒欧洲刀</span><span v-class="on: config.notify_getnew == 3" v-on="click: applyConfig('notify_getnew', 3)">全部</span></div>
            <div class="desc">战斗掉落提醒。</div>
            <div class="desc">亚洲刀包括枪、岩融、大太刀和四花太以及欧洲刀。</div>
            <div class="desc">欧洲刀包括两把欧短、狐球和爷爷。</div>
            <div class="desc">(歐刀判斷待更新)</div>
          </li>
        </ul>
      </div>
    </div>
    <!-- 分頁 #-1：關於套件 -->
    <div v-show="tab==-2">
      <div class="panel-about">
        <div class="t">審神忙 · Tohken Ranbu Helper</div>
        <ul class="sl">
          <li>
            <div class="desc">目前版本： V0.3.0.1111 (Beta)</div>
            <div class="desc">更新時間： 2017年12月21日</div>
            <div class="desc">原作者项目仓库：<a href="https://github.com/hitomi/tohken">https://github.com/hitomi/tohken</a></div>
            <div class="desc">本次更新：<a href="https://github.com/ch890333/tohken">https://github.com/ch890333/tohken</a></div>
          </li>
        </ul>
      </div>
      <div class="panel-about">
        <div class="t">STAFF</div>
        <ul class="sl">
          <li>
            <div class="act">攻城狮</div>
            <div class="desc">原作者：<a href="http://weibo.com/moelynn" target="_blank">@凌</a></div>
            <div class="desc">本次更新人員：<a href="https://www.plurk.com/CymbieWolf" target="_blank">@技術系阿審</a></div>
          </li>

        </ul>
      </div>
      <div class="panel-about">
        <div class="t">目前已知BUG</div>
        <ul class="sl">
          <li>
            <div class="act">使用手伝い札，依然會跳出手入完畢提醒</div>
            <div class="act">界面特别窄时字会堆在一起</div>
            <div class="act">(阿官規格)手伝い札、小判数量僅於登入遊戲時可取得資訊，所以數值不會變化</div>
            <div class="act">(阿官規格)審神者名稱僅於登入遊戲時可取得，若沒有開啟本地暫存，或是先啟動套件再進本丸，會無法顯示審神者的名稱</div>
          </li>
        </ul>
      </div>
      <div class="panel-about">
        <div class="t">更新公告</div>
        <ul class="sl">
          <li>
            <div class="act">v0.3.0.1111 </div>
            <div class="desc">對應https進行解讀修正</div>
            <div class="desc">新增：活動刀#150資訊</div>
            <div class="desc">新增：極打資訊、傳聞中的極化經驗值資訊</div>
            <div class="desc">UI微調：將資材數量從套件header移至[本丸]分頁顯示，避免字體擠成一團</div>
            <div class="desc">其他UI微調：</div>
            <div class="desc">致其他拆包研究的攻城師：已補齊刀帳中推測資料欄位，程式結構化緩慢的進行中</div>
          </li>
          <li>
            <div class="act">v0.3.0.111 </div>
            <div class="desc">修彈出視窗的錯字</div>
          </li>

          <li>
            <div class="act">v0.3.0.11 2017/10/29</div>
            <div class="desc">預先新增三花極打資料</div>
          </li>
          <li>
            <div class="act">v0.3.0.1 2017/10/21</div>
            <div class="desc">新增四花極打與三花極打資料 經測試經驗值顯示OK</div>
            <div class="desc">刀種更新至 大般若長光</div>
            <div class="desc">致其他拆包研究的攻城師：已將程式碼排版為易於閱讀的狀況</div>
          </li>

          <li>
            <div class="act">v0.3.0.</div>
            <div class="desc">Uchigatana Kiwame now have their experience points properly displayed.</div>
          </li>

          <li>
            <div class="act">v0.2.9.1 2017/10/12</div>
            <div class="desc">翻譯並補齊靜態參考資料</div>
            <div class="desc">新增極打資料型態(尚未確認、待補齊)</div>
          </li>

          <li>
            <div class="act">v0.2.9 2017/09/15</div>
            <div class="desc">Wakizashi Kiwame now have their experience points properly displayed (level 55).</div>
            <div class="desc">Update for Uchigatana Kiwame will be implemented once exp values have been determined.</div>
          </li>

          <li>
            <div class="act">v0.2.0 150315</div>
            <div class="desc">* 远征提醒修复</div>
            <div class="desc">+ 手入提醒</div>
            <div class="desc">+ 疲劳演算</div>
            <div class="desc">+ 刀装汇总</div>
            <div class="desc">+ 锻刀和掉落统计</div>
          </li>

        </ul>
      </div>
    </div>
  </div>
  <!-- 第三方資源 -->
  <script src="../../thirdparty/FileSaver.js"></script>
  <script src="../../thirdparty/lodash.js"></script>
  <script src="../../thirdparty/jquery.js"></script>
  <script src="../../thirdparty/vue.js"></script>
  <script src="../../thirdparty/aes.js"></script>
  <script src="../../thirdparty/pad-nopadding-min.js"></script>
  <!-- 套件程式載入 -->
  <script src="./app/define.js"></script>
  <script src="./app/data.js"></script>
  <script src="./app/config.js"></script>
  <script src="./app/store.js"></script>
  <script src="./app/event.js"></script>
  <script src="./app/parse.js"></script>
  <script src="./app/router.js"></script>
  <script src="./app/view.js"></script>
  <script src="./app/app.js"></script>
  <!-- 工程中
  <script src="./app/timer.js"></script>
-->
</body>

</html>